!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(e,n){e.exports=React},function(e,n,t){"use strict";t.r(n);var r,o=t(0),a=t.n(o),c=a.a.createElement("svg",{width:"1792",height:"1792",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:"M1472 992v480q0 26-19 45t-45 19h-384v-384h-256v384h-384q-26 0-45-19t-19-45v-480q0-1 .5-3t.5-3l575-474 575 474q1 2 1 6zm223-69l-62 74q-8 9-21 11h-3q-13 0-21-7l-692-577-692 577q-12 8-24 7-13-2-21-11l-62-74q-8-10-7-23.5t11-21.5l719-599q32-26 76-26t76 26l244 204v-195q0-14 9-23t23-9h192q14 0 23 9t9 23v408l219 182q10 8 11 21.5t-7 23.5z"})),i=(r=function(e,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}r(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),l=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},u=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},p=function(e){function n(n){var t=e.call(this,n)||this;return t.search=function(e){return l(t,void 0,void 0,function(){var n,t,r=this;return u(this,function(o){switch(o.label){case 0:return this.setState({searching:!0}),[4,this.props.doSearch(e)];case 1:return n=o.sent(),this.state.pendingSearch?(t=this.state.pendingSearch,this.setState({pendingSearch:null},function(){r.search(t)}),[2]):(this.setState({searching:!1,entities:n}),[2])}})})},t.onInputChange=function(e){return l(t,void 0,void 0,function(){var n;return u(this,function(t){switch(t.label){case 0:return(n=e.currentTarget.value).length<3?[2]:this.state.searching?(this.setState({pendingSearch:n}),[2]):[4,this.search(n)];case 1:return t.sent(),[2]}})})},t.state={entities:[],searching:!1,hoverIndex:-1,pendingSearch:null},t}return i(n,e),n.prototype.render=function(){var e=this;return a.a.createElement("div",{style:this.props.style},a.a.createElement(wp.components.BaseControl,{id:"search",label:this.props.inputLabel,help:this.props.inputHelp},a.a.createElement("input",{id:"search",style:{width:"100%"},onChange:this.onInputChange})),a.a.createElement("div",{style:{height:"300px",overflowY:"auto"}},this.state.searching?a.a.createElement(wp.components.Placeholder,{style:{height:"300px"}},a.a.createElement(wp.components.Spinner,null)):this.state.entities.map(function(n,t){return a.a.createElement("div",{onMouseOver:function(){return e.setState({hoverIndex:t})},onClick:function(){return e.props.onSelect(n)},style:{fontWeight:e.state.hoverIndex==t?"bold":"normal",cursor:"pointer",paddingTop:"5px",paddingBottom:"5px"},key:n.id},e.props.getDisplayName(n))})))},n}(a.a.Component),s=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),h=(wp.i18n.__,function(e){function n(n){return e.call(this,n)||this}return s(n,e),n.prototype.render=function(){var e=this;return this.props.open?a.a.createElement(wp.components.Modal,{style:{minWidth:"60%"},title:this.props.modalTitle,onRequestClose:function(){return e.props.onClose()}},a.a.createElement(p,{doSearch:this.props.doSearch,inputLabel:this.props.inputLabel,inputHelp:this.props.inputHelp,getDisplayName:this.props.getDisplayName,onSelect:function(n){return e.onSelect(n)},style:{width:"100%"}})):null},n.prototype.onSelect=function(e){this.props.onSelect(e)},n}(a.a.Component)),f=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},v=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},g="https://api.palvelutietovaranto.suomi.fi/api",d=function(){return function(){var e=this;this.findServiceChannel=function(n){return f(e,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this.findServiceChannels([n])];case 1:return[2,e.sent()[0]||null]}})})},this.findService=function(n){return f(e,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this.findServices([n])];case 1:return[2,e.sent()[0]||null]}})})},this.findServiceChannels=function(n){return f(e,void 0,void 0,function(){var e,t,r,o=this;return v(this,function(a){switch(a.label){case 0:return n&&0!=n.length?(e=n.filter(function(e){return!o.channelCache.has(e)})).length>0?[4,(0,wp.apiFetch)({path:"/sptv/version"})]:[3,4]:[2,[]];case 1:return t=a.sent(),[4,fetch("".concat(g,"/").concat(t,"/ServiceChannel/list?guids=").concat(e.join(",")),{credentials:"omit"})];case 2:return[4,a.sent().json()];case 3:(r=a.sent())&&Array.isArray(r)&&r.length>0&&r.forEach(function(e){return o.channelCache.set(e.id,e)}),a.label=4;case 4:return[2,n.length>0?n.map(function(e){return o.channelCache.get(e)}):[]]}})})},this.findServices=function(n){return f(e,void 0,void 0,function(){var e,t,r,o=this;return v(this,function(a){switch(a.label){case 0:return n&&0!=n.length?(e=n.filter(function(e){return!o.serviceCache.has(e)}),t=n.filter(function(n){return!(e.indexOf(n)>-1)}),e.length>0&&0==t.length?[4,(0,wp.apiFetch)({path:"/sptv/version"})]:[3,4]):[2,[]];case 1:return r=a.sent(),[4,fetch("".concat(g,"/").concat(r,"/Service/list?guids=").concat(e.join(",")),{credentials:"omit"})];case 2:return[4,a.sent().json()];case 3:a.sent().forEach(function(e){return o.serviceCache.set(e.id,e)}),a.label=4;case 4:return[2,n.map(function(e){return o.serviceCache.get(e)})]}})})},this.findOrganizations=function(n){return f(e,void 0,void 0,function(){var e,t,r,o=this;return v(this,function(a){switch(a.label){case 0:return n&&0!=n.length?(e=n.filter(function(e){return!o.organizationCache.has(e)}),t=n.filter(function(n){return!(e.indexOf(n)>-1)}),e.length>0&&0==t.length?[4,(0,wp.apiFetch)({path:"/sptv/version"})]:[3,4]):[2,[]];case 1:return r=a.sent(),[4,fetch("".concat(g,"/").concat(r,"/Organization/list?guids=").concat(e.join(",")),{credentials:"omit"})];case 2:return[4,a.sent().json()];case 3:a.sent().forEach(function(e){return o.organizationCache.set(e.id,e)}),a.label=4;case 4:return[2,n.map(function(e){return o.organizationCache.get(e)})]}})})},this.channelCache=new Map,this.serviceCache=new Map,this.organizationCache=new Map}}(),m=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),y=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},C=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},b=wp.i18n.__,w=function(e){function n(n){var t=e.call(this,n)||this;return t.ptv=new d,t.renderLanguageSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=b("Language","sptv"),c=b("Select language of displayed component","sptv"),i=[{value:"fi",label:b("Finnish","sptv")},{value:"sv",label:b("Swedish","sptv")},{value:"en",label:b("Enlish","sptv")}];return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.language,onChange:function(e){return t.props.onLanguageChange(e)},options:i}))},t.renderComponentSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=b("Component","sptv"),c=b("Select displayed component","sptv"),i=sptv.serviceLocationServiceChannelBlock.components.map(function(e){return{value:e.slug,label:e.name}});return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.component,onChange:function(e){return t.props.onComponentChange(e)},options:i}))},t.renderSearchModal=function(){return a.a.createElement(h,{modalTitle:b("Search Services Locations","sptv"),inputLabel:b("Search Services Locations","sptv"),inputHelp:b("Enter some text to search service locations","sptv"),open:t.state.searchOpen,getDisplayName:t.getSearchResultDisplayName,doSearch:t.doSearch,onSelect:t.onSearchModalSelect,onClose:t.onSearchModalClose})},t.doSearch=function(e){return y(t,void 0,void 0,function(){var n,t;return C(this,function(r){switch(r.label){case 0:return"fi","servicelocation",[4,(0,wp.apiFetch)({path:"/sptv/search-service-channels?q=".concat(e,"&type=").concat("servicelocation","&lang=").concat("fi")})];case 1:return n=r.sent(),[4,this.ptv.findServiceChannels(n)];case 2:return t=r.sent(),[2,t.filter(function(e){return void 0!==e})]}})})},t.getSearchResultDisplayName=function(e){return t.getLocalizedValue(e.serviceChannelNames,"fi","Name")},t.onSearchModalSelect=function(e){t.setState({searchOpen:!1}),t.props.onChannelIdChange(e.id)},t.onSearchModalClose=function(){t.setState({searchOpen:!1})},t.onChangeButtonClick=function(){t.setState({searchOpen:!0})},t.state={searchOpen:n.editing&&!n.channelId},t}return m(n,e),n.prototype.componentDidUpdate=function(e,n){},n.prototype.render=function(){var e=wp.blockEditor.InspectorControls;return a.a.createElement(e,null,this.renderLanguageSelect(),this.renderComponentSelect(),this.renderChangeButton(),this.renderSearchModal())},n.prototype.renderChangeButton=function(){return a.a.createElement("div",null,a.a.createElement(wp.components.Button,{variant:"primary",onClick:this.onChangeButtonClick},b("Change service location","sptv")))},n.prototype.getLocalizedValue=function(e,n,t){if(!e||!e.length)return null;var r=e.filter(function(e){return(!t||e.type==t)&&e.value&&e.value.trim()});return r.sort(function(e,t){return e.language===n?-1:1}),r[0]?r[0].value:null},n}(a.a.Component),S=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),E=(wp.i18n.__,function(e){function n(n){var t=e.call(this,n)||this;return t.renderInspectorControls=function(){return a.a.createElement(w,{editing:t.props.editing,channelId:t.props.channelId,language:t.props.language,component:t.props.component,onComponentChange:t.props.onComponentChange,onLanguageChange:t.props.onLanguageChange,onChannelIdChange:t.props.onChannelIdChange})},t.renderPreview=function(){return a.a.createElement("div",null,a.a.createElement(wp.serverSideRender,{block:"sptv/service-location-service-channel-block",attributes:{id:t.props.channelId,language:t.props.language,component:t.props.component}}))},t.state={},t}return S(n,e),n.prototype.render=function(){return a.a.createElement("div",null,this.renderPreview(),this.renderInspectorControls())},n}(a.a.Component)),_=wp.i18n.__;(0,wp.blocks.registerBlockType)("sptv/service-location-service-channel-block",{title:_("Service location service channel","sptv"),icon:c,category:"sptv",attributes:{id:{type:"string"},component:{type:"string"},language:{type:"string"}},edit:function(e){var n=e.isSelected,t=function(n){return e.attributes[n]},r=function(n,t){var r={};r[n]=t,e.setAttributes(r)};return t("component")||r("component",sptv.serviceLocationServiceChannelBlock.components?sptv.serviceLocationServiceChannelBlock.components[0].slug:null),t("language")||r("language","fi"),a.a.createElement(E,{editing:n,channelId:t("id"),component:t("component"),language:t("language"),onComponentChange:function(e){r("component",e)},onLanguageChange:function(e){r("language",e)},onChannelIdChange:function(e){r("id",e)}})},save:function(){return null}});var O=a.a.createElement("svg",{width:"1792",height:"1792",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:"M1120 576q0 13-9.5 22.5t-22.5 9.5-22.5-9.5-9.5-22.5q0-46-54-71t-106-25q-13 0-22.5-9.5t-9.5-22.5 9.5-22.5 22.5-9.5q50 0 99.5 16t87 54 37.5 90zm160 0q0-72-34.5-134t-90-101.5-123-62-136.5-22.5-136.5 22.5-123 62-90 101.5-34.5 134q0 101 68 180 10 11 30.5 33t30.5 33q128 153 141 298h228q13-145 141-298 10-11 30.5-33t30.5-33q68-79 68-180zm128 0q0 155-103 268-45 49-74.5 87t-59.5 95.5-34 107.5q47 28 47 82 0 37-25 64 25 27 25 64 0 52-45 81 13 23 13 47 0 46-31.5 71t-77.5 25q-20 44-60 70t-87 26-87-26-60-70q-46 0-77.5-25t-31.5-71q0-24 13-47-45-29-45-81 0-37 25-64-25-27-25-64 0-54 47-82-4-50-34-107.5t-59.5-95.5-74.5-87q-103-113-103-268 0-99 44.5-184.5t117-142 164-89 186.5-32.5 186.5 32.5 164 89 117 142 44.5 184.5z"})),k=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),x=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},q=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},I=wp.i18n.__,L=function(e){function n(n){var t=e.call(this,n)||this;return t.ptv=new d,t.renderLanguageSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=I("Language","sptv"),c=I("Select language of displayed component","sptv"),i=[{value:"fi",label:I("Finnish","sptv")},{value:"sv",label:I("Swedish","sptv")},{value:"en",label:I("Enlish","sptv")}];return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.language,onChange:function(e){return t.props.onLanguageChange(e)},options:i}))},t.renderComponentSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=I("Component","sptv"),c=I("Select displayed component","sptv"),i=sptv.electronicServiceChannelBlock.components.map(function(e){return{value:e.slug,label:e.name}});return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.component,onChange:function(e){return t.props.onComponentChange(e)},options:i}))},t.renderSearchModal=function(){return a.a.createElement(h,{modalTitle:I("Search Electronic Channel","sptv"),inputLabel:I("Search Electronic Channel","sptv"),inputHelp:I("Enter the first word to search electronic channel","sptv"),open:t.state.searchOpen,getDisplayName:t.getSearchResultDisplayName,doSearch:t.doSearch,onSelect:t.onSearchModalSelect,onClose:t.onSearchModalClose})},t.doSearch=function(e){return x(t,void 0,void 0,function(){var n,t;return q(this,function(r){switch(r.label){case 0:return"fi","echannel",[4,(0,wp.apiFetch)({path:"/sptv/search-service-channels?q=".concat(e,"&type=").concat("echannel","&lang=").concat("fi")})];case 1:return n=r.sent(),[4,this.ptv.findServiceChannels(n)];case 2:return t=r.sent(),[2,t.filter(function(e){return void 0!==e})]}})})},t.getSearchResultDisplayName=function(e){return t.getLocalizedValue(e.serviceChannelNames,"fi","Name")},t.onSearchModalSelect=function(e){t.setState({searchOpen:!1}),t.props.onChannelIdChange(e.id)},t.onSearchModalClose=function(){t.setState({searchOpen:!1})},t.onChangeButtonClick=function(){t.setState({searchOpen:!0})},t.state={searchOpen:n.editing&&!n.channelId},t}return k(n,e),n.prototype.componentDidUpdate=function(e,n){},n.prototype.render=function(){var e=wp.blockEditor.InspectorControls;return a.a.createElement(e,null,this.renderLanguageSelect(),this.renderComponentSelect(),this.renderChangeButton(),this.renderSearchModal())},n.prototype.renderChangeButton=function(){return a.a.createElement("div",null,a.a.createElement(wp.components.Button,{variant:"primary",onClick:this.onChangeButtonClick},I("Change electronic service","sptv")))},n.prototype.getLocalizedValue=function(e,n,t){if(!e||!e.length)return null;var r=e.filter(function(e){return(!t||e.type==t)&&e.value&&e.value.trim()});return r.sort(function(e,t){return e.language===n?-1:1}),r[0]?r[0].value:null},n}(a.a.Component),B=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),P=(wp.i18n.__,function(e){function n(n){var t=e.call(this,n)||this;return t.renderInspectorControls=function(){return a.a.createElement(L,{editing:t.props.editing,channelId:t.props.channelId,language:t.props.language,component:t.props.component,onComponentChange:t.props.onComponentChange,onLanguageChange:t.props.onLanguageChange,onChannelIdChange:t.props.onChannelIdChange})},t.renderPreview=function(){return a.a.createElement("div",null,a.a.createElement(wp.serverSideRender,{block:"sptv/electronic-service-channel-block",attributes:{id:t.props.channelId,language:t.props.language,component:t.props.component}}))},t.state={},t}return B(n,e),n.prototype.render=function(){return a.a.createElement("div",null,this.renderPreview(),this.renderInspectorControls())},n}(a.a.Component)),j=wp.i18n.__;(0,wp.blocks.registerBlockType)("sptv/electronic-service-channel-block",{title:j("Electronic service channel","sptv"),icon:O,category:"sptv",attributes:{id:{type:"string"},component:{type:"string"},language:{type:"string"}},edit:function(e){var n=e.isSelected,t=function(n){return e.attributes[n]},r=function(n,t){var r={};r[n]=t,e.setAttributes(r)};return t("component")||r("component",sptv.electronicServiceChannelBlock.components?sptv.electronicServiceChannelBlock.components[0].slug:null),t("language")||r("language","fi"),a.a.createElement(P,{editing:n,channelId:t("id"),component:t("component"),language:t("language"),onComponentChange:function(e){r("component",e)},onLanguageChange:function(e){r("language",e)},onChannelIdChange:function(e){r("id",e)}})},save:function(){return null}});var T=a.a.createElement("svg",{width:"1792",height:"1792",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:"M1408 928v320q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h704q14 0 23 9t9 23v64q0 14-9 23t-23 9h-704q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113v-320q0-14 9-23t23-9h64q14 0 23 9t9 23zm384-864v512q0 26-19 45t-45 19-45-19l-176-176-652 652q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l652-652-176-176q-19-19-19-45t19-45 45-19h512q26 0 45 19t19 45z"})),M=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),z=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},N=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},D=wp.i18n.__,A=function(e){function n(n){var t=e.call(this,n)||this;return t.ptv=new d,t.renderLanguageSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=D("Language","sptv"),c=D("Select language of displayed component","sptv"),i=[{value:"fi",label:D("Finnish","sptv")},{value:"sv",label:D("Swedish","sptv")},{value:"en",label:D("Enlish","sptv")}];return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.language,onChange:function(e){return t.props.onLanguageChange(e)},options:i}))},t.renderComponentSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=D("Component","sptv"),c=D("Select displayed component","sptv"),i=sptv.webpageServiceChannelBlock.components.map(function(e){return{value:e.slug,label:e.name}});return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.component,onChange:function(e){return t.props.onComponentChange(e)},options:i}))},t.renderSearchModal=function(){return a.a.createElement(h,{modalTitle:D("Search Service Webpages","sptv"),inputLabel:D("Search Service Webpages","sptv"),inputHelp:D("Enter the first word to search service webpages","sptv"),open:t.state.searchOpen,getDisplayName:t.getSearchResultDisplayName,doSearch:t.doSearch,onSelect:t.onSearchModalSelect,onClose:t.onSearchModalClose})},t.doSearch=function(e){return z(t,void 0,void 0,function(){var n,t;return N(this,function(r){switch(r.label){case 0:return"fi","webpage",[4,(0,wp.apiFetch)({path:"/sptv/search-service-channels?q=".concat(e,"&type=").concat("webpage","&lang=").concat("fi")})];case 1:return n=r.sent(),[4,this.ptv.findServiceChannels(n)];case 2:return t=r.sent(),[2,t.filter(function(e){return void 0!==e})]}})})},t.getSearchResultDisplayName=function(e){return t.getLocalizedValue(e.serviceChannelNames,"fi","Name")},t.onSearchModalSelect=function(e){t.setState({searchOpen:!1}),t.props.onChannelIdChange(e.id)},t.onSearchModalClose=function(){t.setState({searchOpen:!1})},t.onChangeButtonClick=function(){t.setState({searchOpen:!0})},t.state={searchOpen:n.editing&&!n.channelId},t}return M(n,e),n.prototype.componentDidUpdate=function(e,n){},n.prototype.render=function(){var e=wp.blockEditor.InspectorControls;return a.a.createElement(e,null,this.renderLanguageSelect(),this.renderComponentSelect(),this.renderChangeButton(),this.renderSearchModal())},n.prototype.renderChangeButton=function(){return a.a.createElement("div",null,a.a.createElement(wp.components.Button,{variant:"primary",onClick:this.onChangeButtonClick},D("Change webpage service","sptv")))},n.prototype.getLocalizedValue=function(e,n,t){if(!e||!e.length)return null;var r=e.filter(function(e){return(!t||e.type==t)&&e.value&&e.value.trim()});return r.sort(function(e,t){return e.language===n?-1:1}),r[0]?r[0].value:null},n}(a.a.Component),R=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),F=(wp.i18n.__,function(e){function n(n){var t=e.call(this,n)||this;return t.renderInspectorControls=function(){return a.a.createElement(A,{editing:t.props.editing,channelId:t.props.channelId,language:t.props.language,component:t.props.component,onComponentChange:t.props.onComponentChange,onLanguageChange:t.props.onLanguageChange,onChannelIdChange:t.props.onChannelIdChange})},t.renderPreview=function(){return a.a.createElement("div",null,a.a.createElement(wp.serverSideRender,{block:"sptv/webpage-service-channel-block",attributes:{id:t.props.channelId,language:t.props.language,component:t.props.component}}))},t.state={},t}return R(n,e),n.prototype.render=function(){return a.a.createElement("div",null,this.renderPreview(),this.renderInspectorControls())},n}(a.a.Component)),V=wp.i18n.__;(0,wp.blocks.registerBlockType)("sptv/webpage-service-channel-block",{title:V("Webpage service channel","sptv"),icon:T,category:"sptv",attributes:{id:{type:"string"},component:{type:"string"},language:{type:"string"}},edit:function(e){var n=e.isSelected,t=function(n){return e.attributes[n]},r=function(n,t){var r={};r[n]=t,e.setAttributes(r)};return t("component")||r("component",sptv.webpageServiceChannelBlock.components?sptv.webpageServiceChannelBlock.components[0].slug:null),t("language")||r("language","fi"),a.a.createElement(F,{editing:n,channelId:t("id"),component:t("component"),language:t("language"),onComponentChange:function(e){r("component",e)},onLanguageChange:function(e){r("language",e)},onChannelIdChange:function(e){r("id",e)}})},save:function(){return null}});var G=a.a.createElement("svg",{width:"1792",height:"1792",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:"M384 1408q0 80-56 136t-136 56-136-56-56-136 56-136 136-56 136 56 56 136zm0-512q0 80-56 136t-136 56-136-56-56-136 56-136 136-56 136 56 56 136zm1408 416v192q0 13-9.5 22.5t-22.5 9.5h-1216q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1216q13 0 22.5 9.5t9.5 22.5zm-1408-928q0 80-56 136t-136 56-136-56-56-136 56-136 136-56 136 56 56 136zm1408 416v192q0 13-9.5 22.5t-22.5 9.5h-1216q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1216q13 0 22.5 9.5t9.5 22.5zm0-512v192q0 13-9.5 22.5t-22.5 9.5h-1216q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1216q13 0 22.5 9.5t9.5 22.5z"})),H=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),U=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},W=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},Y=wp.i18n.__,J=function(e){function n(n){var t=e.call(this,n)||this;return t.ptv=new d,t.renderLanguageSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=Y("Language","sptv"),c=Y("Select language of displayed component","sptv"),i=[{value:"fi",label:Y("Finnish","sptv")},{value:"sv",label:Y("Swedish","sptv")},{value:"en",label:Y("Enlish","sptv")}];return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.language,onChange:function(e){return t.props.onLanguageChange(e)},options:i}))},t.renderComponentSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=Y("Component","sptv"),c=Y("Select displayed component","sptv"),i=sptv.printableFormServiceChannelBlock.components.map(function(e){return{value:e.slug,label:e.name}});return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.component,onChange:function(e){return t.props.onComponentChange(e)},options:i}))},t.renderSearchModal=function(){return a.a.createElement(h,{modalTitle:Y("Search Printable Form Services","sptv"),inputLabel:Y("Search Printable Form Services","sptv"),inputHelp:Y("Enter the first word to search printable form services","sptv"),open:t.state.searchOpen,getDisplayName:t.getSearchResultDisplayName,doSearch:t.doSearch,onSelect:t.onSearchModalSelect,onClose:t.onSearchModalClose})},t.doSearch=function(e){return U(t,void 0,void 0,function(){var n,t;return W(this,function(r){switch(r.label){case 0:return"fi","printableform",[4,(0,wp.apiFetch)({path:"/sptv/search-service-channels?q=".concat(e,"&type=").concat("printableform","&lang=").concat("fi")})];case 1:return n=r.sent(),[4,this.ptv.findServiceChannels(n)];case 2:return t=r.sent(),[2,t.filter(function(e){return void 0!==e})]}})})},t.getSearchResultDisplayName=function(e){return t.getLocalizedValue(e.serviceChannelNames,"fi","Name")},t.onSearchModalSelect=function(e){t.setState({searchOpen:!1}),t.props.onChannelIdChange(e.id)},t.onSearchModalClose=function(){t.setState({searchOpen:!1})},t.onChangeButtonClick=function(){t.setState({searchOpen:!0})},t.state={searchOpen:n.editing&&!n.channelId},t}return H(n,e),n.prototype.componentDidUpdate=function(e,n){},n.prototype.render=function(){var e=wp.blockEditor.InspectorControls;return a.a.createElement(e,null,this.renderLanguageSelect(),this.renderComponentSelect(),this.renderChangeButton(),this.renderSearchModal())},n.prototype.renderChangeButton=function(){return a.a.createElement("div",null,a.a.createElement(wp.components.Button,{variant:"primary",onClick:this.onChangeButtonClick},Y("Change printable form service","sptv")))},n.prototype.getLocalizedValue=function(e,n,t){if(!e||!e.length)return null;var r=e.filter(function(e){return(!t||e.type==t)&&e.value&&e.value.trim()});return r.sort(function(e,t){return e.language===n?-1:1}),r[0]?r[0].value:null},n}(a.a.Component),K=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Q=(wp.i18n.__,function(e){function n(n){var t=e.call(this,n)||this;return t.renderInspectorControls=function(){return a.a.createElement(J,{editing:t.props.editing,channelId:t.props.channelId,language:t.props.language,component:t.props.component,onComponentChange:t.props.onComponentChange,onLanguageChange:t.props.onLanguageChange,onChannelIdChange:t.props.onChannelIdChange})},t.renderPreview=function(){return a.a.createElement("div",null,a.a.createElement(wp.serverSideRender,{block:"sptv/printable-form-service-channel-block",attributes:{id:t.props.channelId,language:t.props.language,component:t.props.component}}))},t.state={},t}return K(n,e),n.prototype.render=function(){return a.a.createElement("div",null,this.renderPreview(),this.renderInspectorControls())},n}(a.a.Component)),X=wp.i18n.__;(0,wp.blocks.registerBlockType)("sptv/printable-form-service-channel-block",{title:X("Printable form service channel","sptv"),icon:G,category:"sptv",attributes:{id:{type:"string"},component:{type:"string"},language:{type:"string"}},edit:function(e){var n=e.isSelected,t=function(n){return e.attributes[n]},r=function(n,t){var r={};r[n]=t,e.setAttributes(r)};return t("component")||r("component",sptv.printableFormServiceChannelBlock.components?sptv.printableFormServiceChannelBlock.components[0].slug:null),t("language")||r("language","fi"),a.a.createElement(Q,{editing:n,channelId:t("id"),component:t("component"),language:t("language"),onComponentChange:function(e){r("component",e)},onLanguageChange:function(e){r("language",e)},onChannelIdChange:function(e){r("id",e)}})},save:function(){return null}});var Z=a.a.createElement("svg",{width:"1792",height:"1792",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:"M1600 1240q0 27-10 70.5t-21 68.5q-21 50-122 106-94 51-186 51-27 0-53-3.5t-57.5-12.5-47-14.5-55.5-20.5-49-18q-98-35-175-83-127-79-264-216t-216-264q-48-77-83-175-3-9-18-49t-20.5-55.5-14.5-47-12.5-57.5-3.5-53q0-92 51-186 56-101 106-122 25-11 68.5-21t70.5-10q14 0 21 3 18 6 53 76 11 19 30 54t35 63.5 31 53.5q3 4 17.5 25t21.5 35.5 7 28.5q0 20-28.5 50t-62 55-62 53-28.5 46q0 9 5 22.5t8.5 20.5 14 24 11.5 19q76 137 174 235t235 174q2 1 19 11.5t24 14 20.5 8.5 22.5 5q18 0 46-28.5t53-62 55-62 50-28.5q14 0 28.5 7t35.5 21.5 25 17.5q25 15 53.5 31t63.5 35 54 30q70 35 76 53 3 7 3 21z"})),$=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),ee=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},ne=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},te=wp.i18n.__,re=function(e){function n(n){var t=e.call(this,n)||this;return t.ptv=new d,t.renderLanguageSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=te("Language","sptv"),c=te("Select language of displayed component","sptv"),i=[{value:"fi",label:te("Finnish","sptv")},{value:"sv",label:te("Swedish","sptv")},{value:"en",label:te("Enlish","sptv")}];return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.language,onChange:function(e){return t.props.onLanguageChange(e)},options:i}))},t.renderComponentSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=te("Component","sptv"),c=te("Select displayed component","sptv"),i=sptv.phoneServiceChannelBlock.components.map(function(e){return{value:e.slug,label:e.name}});return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.component,onChange:function(e){return t.props.onComponentChange(e)},options:i}))},t.renderSearchModal=function(){return a.a.createElement(h,{modalTitle:te("Search Phone Services","sptv"),inputLabel:te("Search Phone Services","sptv"),inputHelp:te("Enter the first word to search phone services","sptv"),open:t.state.searchOpen,getDisplayName:t.getSearchResultDisplayName,doSearch:t.doSearch,onSelect:t.onSearchModalSelect,onClose:t.onSearchModalClose})},t.doSearch=function(e){return ee(t,void 0,void 0,function(){var n,t;return ne(this,function(r){switch(r.label){case 0:return"fi","phone",[4,(0,wp.apiFetch)({path:"/sptv/search-service-channels?q=".concat(e,"&type=").concat("phone","&lang=").concat("fi")})];case 1:return n=r.sent(),[4,this.ptv.findServiceChannels(n)];case 2:return t=r.sent(),[2,t.filter(function(e){return void 0!==e})]}})})},t.getSearchResultDisplayName=function(e){return t.getLocalizedValue(e.serviceChannelNames,"fi","Name")},t.onSearchModalSelect=function(e){t.setState({searchOpen:!1}),t.props.onChannelIdChange(e.id)},t.onSearchModalClose=function(){t.setState({searchOpen:!1})},t.onChangeButtonClick=function(){t.setState({searchOpen:!0})},t.state={searchOpen:n.editing&&!n.channelId},t}return $(n,e),n.prototype.componentDidUpdate=function(e,n){},n.prototype.render=function(){var e=wp.blockEditor.InspectorControls;return a.a.createElement(e,null,this.renderLanguageSelect(),this.renderComponentSelect(),this.renderChangeButton(),this.renderSearchModal())},n.prototype.renderChangeButton=function(){return a.a.createElement("div",null,a.a.createElement(wp.components.Button,{variant:"primary",onClick:this.onChangeButtonClick},te("Change phone service","sptv")))},n.prototype.getLocalizedValue=function(e,n,t){if(!e||!e.length)return null;var r=e.filter(function(e){return(!t||e.type==t)&&e.value&&e.value.trim()});return r.sort(function(e,t){return e.language===n?-1:1}),r[0]?r[0].value:null},n}(a.a.Component),oe=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),ae=(wp.i18n.__,function(e){function n(n){var t=e.call(this,n)||this;return t.renderInspectorControls=function(){return a.a.createElement(re,{editing:t.props.editing,channelId:t.props.channelId,language:t.props.language,component:t.props.component,onComponentChange:t.props.onComponentChange,onLanguageChange:t.props.onLanguageChange,onChannelIdChange:t.props.onChannelIdChange})},t.renderPreview=function(){return a.a.createElement("div",null,a.a.createElement(wp.serverSideRender,{block:"sptv/phone-service-channel-block",attributes:{id:t.props.channelId,language:t.props.language,component:t.props.component}}))},t.state={},t}return oe(n,e),n.prototype.render=function(){return a.a.createElement("div",null,this.renderPreview(),this.renderInspectorControls())},n}(a.a.Component)),ce=wp.i18n.__;(0,wp.blocks.registerBlockType)("sptv/phone-service-channel-block",{title:ce("Phone service channel","sptv"),icon:Z,category:"sptv",attributes:{id:{type:"string"},component:{type:"string"},language:{type:"string"}},edit:function(e){var n=e.isSelected,t=function(n){return e.attributes[n]},r=function(n,t){var r={};r[n]=t,e.setAttributes(r)};return t("component")||r("component",sptv.phoneServiceChannelBlock.components?sptv.phoneServiceChannelBlock.components[0].slug:null),t("language")||r("language","fi"),a.a.createElement(ae,{editing:n,channelId:t("id"),component:t("component"),language:t("language"),onComponentChange:function(e){r("component",e)},onLanguageChange:function(e){r("language",e)},onChannelIdChange:function(e){r("id",e)}})},save:function(){return null}});var ie=a.a.createElement("svg",{width:"2048",height:"1792",viewBox:"0 0 2048 1792",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:"M256 1024h1728q26 0 45 19t19 45v448h-256v-256h-1536v256h-256v-1216q0-26 19-45t45-19h128q26 0 45 19t19 45v704zm576-320q0-106-75-181t-181-75-181 75-75 181 75 181 181 75 181-75 75-181zm1216 256v-64q0-159-112.5-271.5t-271.5-112.5h-704q-26 0-45 19t-19 45v384h1152z"})),le=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),ue=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},pe=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},se=wp.i18n.__,he=function(e){function n(n){var t=e.call(this,n)||this;return t.ptv=new d,t.renderLanguageSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=se("Language","sptv"),c=se("Select language of displayed component","sptv"),i=[{value:"fi",label:se("Finnish","sptv")},{value:"sv",label:se("Swedish","sptv")},{value:"en",label:se("Enlish","sptv")}];return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.language,onChange:function(e){return t.props.onLanguageChange(e)},options:i}))},t.renderComponentSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=se("Component","sptv"),c=se("Select displayed component","sptv"),i=sptv.serviceBlock.components.map(function(e){return{value:e.slug,label:e.name}});return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.component,onChange:function(e){return t.props.onComponentChange(e)},options:i}))},t.renderSearchModal=function(){return a.a.createElement(h,{modalTitle:se("Search Services","sptv"),inputLabel:se("Search Services","sptv"),inputHelp:se("Enter the first word to search services","sptv"),open:t.state.searchOpen,getDisplayName:t.getSearchResultDisplayName,doSearch:t.doSearch,onSelect:t.onSearchModalSelect,onClose:t.onSearchModalClose})},t.doSearch=function(e){return ue(t,void 0,void 0,function(){var n,t;return pe(this,function(r){switch(r.label){case 0:return"fi",[4,(0,wp.apiFetch)({path:"/sptv/search-services?q=".concat(e,"&lang=").concat("fi")})];case 1:return n=r.sent(),[4,this.ptv.findServices(n)];case 2:return t=r.sent(),[2,t.filter(function(e){return void 0!==e})]}})})},t.getSearchResultDisplayName=function(e){return t.getLocalizedValue(e.serviceNames,"fi","Name")},t.onSearchModalSelect=function(e){t.setState({searchOpen:!1}),t.props.onServiceIdChange(e.id)},t.onSearchModalClose=function(){t.setState({searchOpen:!1})},t.onChangeButtonClick=function(){t.setState({searchOpen:!0})},t.state={searchOpen:n.editing&&!n.serviceId},t}return le(n,e),n.prototype.componentDidUpdate=function(e,n){},n.prototype.render=function(){var e=wp.blockEditor.InspectorControls;return a.a.createElement(e,null,this.renderLanguageSelect(),this.renderComponentSelect(),this.renderChangeButton(),this.renderSearchModal())},n.prototype.renderChangeButton=function(){return a.a.createElement("div",null,a.a.createElement(wp.components.Button,{variant:"primary",onClick:this.onChangeButtonClick},se("Change service","sptv")))},n.prototype.getLocalizedValue=function(e,n,t){if(!e||!e.length)return null;var r=e.filter(function(e){return(!t||e.type==t)&&e.value&&e.value.trim()});return r.sort(function(e,t){return e.language===n?-1:1}),r[0]?r[0].value:null},n}(a.a.Component),fe=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),ve=(wp.i18n.__,function(e){function n(n){var t=e.call(this,n)||this;return t.renderInspectorControls=function(){return a.a.createElement(he,{editing:t.props.editing,serviceId:t.props.serviceId,language:t.props.language,component:t.props.component,onComponentChange:t.props.onComponentChange,onLanguageChange:t.props.onLanguageChange,onServiceIdChange:t.props.onServiceIdChange})},t.renderPreview=function(){return a.a.createElement("div",null,a.a.createElement(wp.serverSideRender,{block:"sptv/service-block",attributes:{id:t.props.serviceId,language:t.props.language,component:t.props.component}}))},t.state={},t}return fe(n,e),n.prototype.render=function(){return a.a.createElement("div",null,this.renderPreview(),this.renderInspectorControls())},n}(a.a.Component)),ge=wp.i18n.__;(0,wp.blocks.registerBlockType)("sptv/service-block",{title:ge("Service","sptv"),icon:ie,category:"sptv",attributes:{id:{type:"string"},component:{type:"string"},language:{type:"string"}},edit:function(e){var n=e.isSelected,t=function(n){return e.attributes[n]},r=function(n,t){var r={};r[n]=t,e.setAttributes(r)};return t("component")||r("component",sptv.serviceBlock.components?sptv.serviceBlock.components[0].slug:null),t("language")||r("language","fi"),a.a.createElement(ve,{editing:n,serviceId:t("id"),component:t("component"),language:t("language"),onComponentChange:function(e){r("component",e)},onLanguageChange:function(e){r("language",e)},onServiceIdChange:function(e){r("id",e)}})},save:function(){return null}});var de=a.a.createElement("svg",{width:"2048",height:"1792",viewBox:"0 0 2048 1792",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("path",{d:"M1792 1248v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96v-192h-512v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96v-192h-512v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96v-192q0-52 38-90t90-38h512v-192h-96q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h320q40 0 68 28t28 68v320q0 40-28 68t-68 28h-96v192h512q52 0 90 38t38 90v192h96q40 0 68 28t28 68z"})),me=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),ye=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},Ce=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},be=(wp.i18n.__,function(e){function n(n){var t=e.call(this,n)||this;return t.componentDidMount=function(){return ye(t,void 0,void 0,function(){return Ce(this,function(e){switch(e.label){case 0:return[4,this.search()];case 1:return e.sent(),[2]}})})},t.search=function(){return ye(t,void 0,void 0,function(){var e;return Ce(this,function(n){switch(n.label){case 0:return this.setState({searching:!0}),[4,this.props.doSearch()];case 1:return e=n.sent(),this.setState({searching:!1,entities:e}),[2]}})})},t.state={entities:[],searching:!1,hoverIndex:-1},t}return me(n,e),n.prototype.render=function(){var e=this;return this.props.open?a.a.createElement(wp.components.Modal,{style:{minWidth:"60%"},title:this.props.modalTitle,onRequestClose:function(){return e.props.onClose()}},a.a.createElement("div",{style:{height:"300px",overflowY:"auto"}},this.state.searching?a.a.createElement(wp.components.Placeholder,{style:{height:"300px"}},a.a.createElement(wp.components.Spinner,null)):this.state.entities.map(function(n,t){return a.a.createElement("div",{onMouseOver:function(){return e.setState({hoverIndex:t})},onClick:function(){return e.onSelect(n)},style:{fontWeight:e.state.hoverIndex==t?"bold":"normal",cursor:"pointer",paddingTop:"5px",paddingBottom:"5px"},key:n.id},e.props.getDisplayName(n))}))):null},n.prototype.onSelect=function(e){this.props.onSelect(e)},n}(a.a.Component)),we=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Se=function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function c(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(c,i)}l((r=r.apply(e,n||[])).next())})},Ee=function(e,n){var t,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},_e=wp.i18n.__,Oe=function(e){function n(n){var t=e.call(this,n)||this;return t.ptv=new d,t.renderLanguageSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=_e("Language","sptv"),c=_e("Select language of displayed component","sptv"),i=[{value:"fi",label:_e("Finnish","sptv")},{value:"sv",label:_e("Swedish","sptv")},{value:"en",label:_e("Enlish","sptv")}];return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.language,onChange:function(e){return t.props.onLanguageChange(e)},options:i}))},t.renderComponentSelect=function(){var e=wp.components,n=e.SelectControl,r=e.Tooltip,o=_e("Component","sptv"),c=_e("Select displayed component","sptv"),i=sptv.organizationBlock.components.map(function(e){return{value:e.slug,label:e.name}});return a.a.createElement("div",null,a.a.createElement(r,{text:c},a.a.createElement("label",null," ",o," ")),a.a.createElement(n,{value:t.props.component,onChange:function(e){return t.props.onComponentChange(e)},options:i}))},t.renderSearchModal=function(){return a.a.createElement(be,{modalTitle:_e("Search organizations","sptv"),open:t.state.searchOpen,getDisplayName:t.getSearchResultDisplayName,doSearch:t.doSearch,onSelect:t.onSearchModalSelect,onClose:t.onSearchModalClose})},t.doSearch=function(){return Se(t,void 0,void 0,function(){var e,n;return Ee(this,function(t){switch(t.label){case 0:return e=Object.values(sptv.organizationBlock.organizationIds),[4,this.ptv.findOrganizations(e)];case 1:return n=t.sent(),[2,n.filter(function(e){return void 0!==e})]}})})},t.getSearchResultDisplayName=function(e){return t.getLocalizedValue(e.organizationNames,"fi","Name")},t.onSearchModalSelect=function(e){t.setState({searchOpen:!1}),t.props.onOrganizationIdChange(e.id)},t.onSearchModalClose=function(){t.setState({searchOpen:!1})},t.onChangeButtonClick=function(){t.setState({searchOpen:!0})},t.state={searchOpen:n.editing&&!n.organizationId},t}return we(n,e),n.prototype.componentDidUpdate=function(e,n){},n.prototype.render=function(){var e=wp.blockEditor.InspectorControls;return a.a.createElement(e,null,this.renderLanguageSelect(),this.renderComponentSelect(),this.renderChangeButton(),this.renderSearchModal())},n.prototype.renderChangeButton=function(){return a.a.createElement("div",null,a.a.createElement(wp.components.Button,{variant:"primary",onClick:this.onChangeButtonClick},_e("Change organization","sptv")))},n.prototype.getLocalizedValue=function(e,n,t){if(!e||!e.length)return null;var r=e.filter(function(e){return(!t||e.type==t)&&e.value&&e.value.trim()});return r.sort(function(e,t){return e.language===n?-1:1}),r[0]?r[0].value:null},n}(a.a.Component),ke=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),xe=(wp.i18n.__,function(e){function n(n){var t=e.call(this,n)||this;return t.renderInspectorControls=function(){return a.a.createElement(Oe,{editing:t.props.editing,organizationId:t.props.organizationId,language:t.props.language,component:t.props.component,onComponentChange:t.props.onComponentChange,onLanguageChange:t.props.onLanguageChange,onOrganizationIdChange:t.props.onOrganizationIdChange})},t.renderPreview=function(){return a.a.createElement("div",null,a.a.createElement(wp.serverSideRender,{block:"sptv/organization-block",attributes:{id:t.props.organizationId,language:t.props.language,component:t.props.component}}))},t.state={},t}return ke(n,e),n.prototype.render=function(){return a.a.createElement("div",null,this.renderPreview(),this.renderInspectorControls())},n}(a.a.Component)),qe=wp.i18n.__;(0,wp.blocks.registerBlockType)("sptv/organization-block",{title:qe("Organization","sptv"),icon:de,category:"sptv",attributes:{id:{type:"string"},component:{type:"string"},language:{type:"string"}},edit:function(e){var n=e.isSelected,t=function(n){return e.attributes[n]},r=function(n,t){var r={};r[n]=t,e.setAttributes(r)};return t("component")||r("component",sptv.organizationBlock.components?sptv.organizationBlock.components[0].slug:null),t("language")||r("language","fi"),a.a.createElement(xe,{editing:n,organizationId:t("id"),component:t("component"),language:t("language"),onComponentChange:function(e){r("component",e)},onLanguageChange:function(e){r("language",e)},onOrganizationIdChange:function(e){r("id",e)}})},save:function(){return null}})}]);